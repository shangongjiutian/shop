"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[523],{2170:function(t,c,a){a.d(c,{r:function(){return n}});var e=a(3907),s=a(6252);const n=t=>{const c=(0,e.oR)(),a=c.state.cartList,n=(t,a,e,s)=>{c.commit("changeCartInfo",{shopId:t,productId:a,productInfo:e,num:s})},o=(0,s.Fl)((()=>{const c=a[t]?.productList||{},e={};for(const t in c){const a=c[t];a.count>0&&(e[t]=a)}return e})),r=(0,s.Fl)((()=>{const c=a[t]?.productList||{},e={};for(const t in c){const a=c[t];a.check&&a.count>0&&(e[t]=a)}return e})),i=(0,s.Fl)((()=>{const c=a[t]?.shopName||"";return c})),_=(0,s.Fl)((()=>{const c=a[t]?.productList,e={total:0,price:0,allChecked:!0};if(c)for(const t in c){const a=c[t];a.check&&(e.price+=a.count*a.price,e.total+=a.count),a.count>0&&!a.check&&(e.allChecked=!1)}return e.price>0&&(e.price=e.price.toFixed(2)),e}));return{cartList:a,changeCartInfo:n,productList:o,shopName:i,calacutions:_,orderProductList:r}}},2210:function(t,c,a){a.d(c,{Z:function(){return L}});var e=a(6252),s=a(3577);const n=t=>((0,e.dD)("data-v-29f0384e"),t=t(),(0,e.Cn)(),t),o={class:"shop"},r=["src"],i={class:"shop__content__title"},_={class:"shop__content__tags"},l={class:"shop__content__tag"},d={class:"shop__content__tag"},p={class:"shop__content__tag"},u={class:"shop__content__highlight"},h={key:0,class:"shop__products"},m=["src"],C={class:"product__title"},k={class:"product__price"},g=n((()=>(0,e._)("span",{class:"product__price__yen"},"¥",-1))),v={class:"product__price__old"};function w(t,c,a,n,w,I){return(0,e.wg)(),(0,e.iD)("div",o,[(0,e._)("img",{class:"shop__img",src:a.item.imgUrl},null,8,r),(0,e._)("div",{class:(0,s.C_)({shop__content:!0,"shop__content--bordered":!a.hideBorder})},[(0,e._)("div",i,(0,s.zw)(a.item.name),1),(0,e._)("div",_,[(0,e._)("span",l,"月售"+(0,s.zw)(a.item.sales),1),(0,e._)("span",d,"起送￥"+(0,s.zw)(a.item.expressLimit),1),(0,e._)("span",p,"基础运费￥"+(0,s.zw)(a.item.expressPrice),1)]),(0,e._)("p",u,(0,s.zw)(a.item.slogan),1),a.item.products?((0,e.wg)(),(0,e.iD)("div",h,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(a.item.products,(t=>((0,e.wg)(),(0,e.iD)("div",{class:"product",key:t.name},[(0,e._)("img",{class:"product__img",src:t.imgUrl},null,8,m),(0,e._)("p",C,(0,s.zw)(t.name),1),(0,e._)("p",k,[g,(0,e.Uk)(" "+(0,s.zw)(t.price)+" ",1),(0,e._)("span",v,(0,s.zw)(t.oldPrice),1)])])))),128))])):(0,e.kq)("",!0)],2)])}var I={name:"ShopInfo",props:["item","hideBorder"]},f=a(3744);const b=(0,f.Z)(I,[["render",w],["__scopeId","data-v-29f0384e"]]);var L=b},2565:function(t,c,a){a.r(c),a.d(c,{default:function(){return kt}});var e=a(6252),s=a(9963);const n=t=>((0,e.dD)("data-v-1c798403"),t=t(),(0,e.Cn)(),t),o={class:"wrapper"},r={class:"search"},i=n((()=>(0,e._)("div",{class:"search__content"},[(0,e._)("span",{class:"search__content__icon iconfont"},""),(0,e._)("input",{class:"search__content__input",placeholder:"请输入商品名称"})],-1)));function _(t,c,a,n,_,l){const d=(0,e.up)("ShopInfo"),p=(0,e.up)("Content"),u=(0,e.up)("Cart");return(0,e.wg)(),(0,e.iD)("div",o,[(0,e._)("div",r,[(0,e._)("div",{class:"search__back iconfont",onClick:c[0]||(c[0]=(...t)=>n.handleBackClick&&n.handleBackClick(...t))},""),i]),(0,e.wy)((0,e.Wm)(d,{item:n.item,hideBorder:!0},null,8,["item"]),[[s.F8,n.item.imgUrl]]),(0,e.Wm)(p,{shopName:n.item.name},null,8,["shopName"]),(0,e.Wm)(u)])}var l=a(2262),d=a(2201),p=a(2210),u=a(1117),h=a(3577);const m=t=>((0,e.dD)("data-v-a34a3018"),t=t(),(0,e.Cn)(),t),C={class:"content"},k={class:"category"},g=["onClick"],v={class:"product"},w=["src"],I={class:"product__item__detail"},f={class:"product__item__title"},b={class:"product__item__sales"},L={class:"product__item__price"},D=m((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),y={class:"product__item__origin"},z={class:"product__number"},U=["onClick"],S=["onClick"];function T(t,c,a,s,n,o){return(0,e.wg)(),(0,e.iD)("div",C,[(0,e._)("div",k,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(s.categories,(t=>((0,e.wg)(),(0,e.iD)("div",{class:(0,h.C_)({category__item:!0,"category__item--active":s.currentTab===t.tab}),onClick:()=>s.handleTabClick(t.tab),key:t.name},(0,h.zw)(t.name),11,g)))),128))]),(0,e._)("div",v,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(s.list,(t=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:t._id},[(0,e._)("img",{class:"product__item__img",src:t.imgUrl},null,8,w),(0,e._)("div",I,[(0,e._)("h4",f,(0,h.zw)(t.name),1),(0,e._)("p",b,"月售"+(0,h.zw)(t.sales)+"件",1),(0,e._)("p",L,[D,(0,e.Uk)((0,h.zw)(t.price)+" ",1),(0,e._)("span",y,"¥"+(0,h.zw)(t.oldPrice),1)])]),(0,e._)("div",z,[(0,e._)("span",{class:"product__number__minus iconfont",onClick:()=>{s.changeCartItem(s.shopId,t._id,t,-1,a.shopName)}},"",8,U),(0,e.Uk)(" "+(0,h.zw)(s.getCratCount(s.shopId,t._id))+" ",1),(0,e._)("span",{class:"product__number__plus iconfont",onClick:()=>{s.changeCartItem(s.shopId,t._id,t,1,a.shopName)}},"",8,S)])])))),128))])])}var H=a(3907),B=a(2170);const N=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"}],F=()=>{const t=(0,l.iH)(N[0].tab),c=c=>{t.value=c};return{currentTab:t,handleTabClick:c}},K=(t,c)=>{const a=(0,l.qj)({list:[]}),s=async()=>{const e=await(0,u.U)(`/api/shop/${c}/products`,{tab:t.value});0===e?.errno&&e?.data&&(a.list=e.data)};(0,e.m0)((()=>{s()}));const{list:n}=(0,l.BK)(a);return{list:n}},Z=()=>{const t=(0,H.oR)(),{changeCartInfo:c,cartList:a}=(0,B.r)(),e=(c,a)=>{t.commit("changeShopName",{shopId:c,shopName:a})},s=(t,a,s,n,o)=>{c(t,a,s,n),e(t,o)},n=(c,a)=>{const e=t.state.cartList;return e?.[c]?.productList?.[a]?.count||0};return{changeCartItem:s,cartList:a,getCratCount:n}};var j={name:"Content",props:["shopName"],setup(){const t=(0,d.yj)(),c=t.params.id,{currentTab:a,handleTabClick:e}=F(),{list:s}=K(a,c),{cartList:n,changeCartItem:o,getCratCount:r}=Z();return{list:s,currentTab:a,categories:N,handleTabClick:e,shopId:c,cartList:n,changeCartItem:o,getCratCount:r}}},q=a(3744);const P=(0,q.Z)(j,[["render",T],["__scopeId","data-v-a34a3018"]]);var Y=P;const M=t=>((0,e.dD)("data-v-7f52b260"),t=t(),(0,e.Cn)(),t),W={class:"cart"},x={key:0,class:"product"},R={class:"product__header"},$=["innerHTML"],O=["innerHTML","onClick"],A=["src"],E={class:"product__item__detail"},G={class:"product__item__title"},J={class:"product__item__price"},Q=M((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),V={class:"product__item__origin"},X={class:"product__number"},tt=["onClick"],ct=["onClick"],at={class:"check"},et=M((()=>(0,e._)("img",{class:"check__icon__img",src:"http://www.dell-lee.com/imgs/vue3/basket.png"},null,-1))),st={class:"check__icon__tag"},nt={class:"check__info"},ot={class:"check__info__price"},rt={class:"check__btn"};function it(t,c,a,n,o,r){const i=(0,e.up)("router-link");return(0,e.wg)(),(0,e.iD)(e.HY,null,[n.showCart?((0,e.wg)(),(0,e.iD)("div",{key:0,class:"mask",onClick:c[0]||(c[0]=(...t)=>n.handleClickCartShow&&n.handleClickCartShow(...t))})):(0,e.kq)("",!0),(0,e._)("div",W,[n.showCart?((0,e.wg)(),(0,e.iD)("div",x,[(0,e._)("div",R,[(0,e._)("div",{class:"product__header__check",onClick:c[1]||(c[1]=()=>n.setCartItemChecked(n.shopId,n.calacutions.allChecked))},[(0,e._)("span",{class:"iconfont",innerHTML:n.calacutions.allChecked?"":""},null,8,$),(0,e.Uk)("全选")]),(0,e._)("div",{class:"product__header__del",onClick:c[2]||(c[2]=()=>{n.changeCartClear(n.shopId)})},"清空购物车")]),((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(n.productList,(t=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:t._id},[(0,e._)("div",{class:"product__item__check iconfont",innerHTML:t.check?"":"",onClick:()=>{n.changeItemCheck(n.shopId,t._id)}},null,8,O),(0,e._)("img",{class:"product__item__img",src:t.imgUrl},null,8,A),(0,e._)("div",E,[(0,e._)("h4",G,(0,h.zw)(t.name),1),(0,e._)("p",J,[Q,(0,e.Uk)((0,h.zw)(t.price)+" ",1),(0,e._)("span",V,"¥"+(0,h.zw)(t.oldPrice),1)])]),(0,e._)("div",X,[(0,e._)("span",{class:"product__number__minus iconfont",onClick:()=>{n.changeCartInfo(n.shopId,t._id,t,-1)}},"",8,tt),(0,e.Uk)(" "+(0,h.zw)(t.count||0)+" ",1),(0,e._)("span",{class:"product__number__plus iconfont",onClick:()=>{n.changeCartInfo(n.shopId,t._id,t,1)}},"",8,ct)])])))),128))])):(0,e.kq)("",!0),(0,e._)("div",at,[(0,e._)("div",{class:"check__icon",onClick:c[3]||(c[3]=(...t)=>n.handleClickCartShow&&n.handleClickCartShow(...t))},[et,(0,e._)("div",st,(0,h.zw)(n.calacutions.total),1)]),(0,e._)("div",nt,[(0,e.Uk)("总计："),(0,e._)("span",ot,"¥"+(0,h.zw)(n.calacutions.price),1)]),(0,e.wy)((0,e._)("div",rt,[(0,e.Wm)(i,{to:{path:`/OrderConfirmation/${n.shopId}`}},{default:(0,e.w5)((()=>[(0,e.Uk)("去结算")])),_:1},8,["to"])],512),[[s.F8,n.calacutions.total>0]])])])],64)}const _t=t=>{const{changeCartInfo:c,cartList:a,productList:e,calacutions:s}=(0,B.r)(t),n=(0,H.oR)(),o=(t,c)=>{n.commit("changeItemChecked",{shopId:t,productId:c})},r=t=>{d.value=!1,n.commit("changeCartClear",{shopId:t})},i=(t,c)=>{n.commit("setCartItemChecked",{shopId:t,allChecked:c})},_=()=>{d.value=!d.value},d=(0,l.iH)(!1);return{calacutions:s,productList:e,changeCartInfo:c,changeItemCheck:o,changeCartClear:r,setCartItemChecked:i,showCart:d,handleClickCartShow:_,cartList:a}};var lt={name:"Cart",setup(){const t=(0,d.yj)(),c=t.params.id,{calacutions:a,productList:e,cartList:s,changeCartInfo:n,changeItemCheck:o,changeCartClear:r,setCartItemChecked:i,showCart:_,handleClickCartShow:l}=_t(c);return{calacutions:a,productList:e,shopId:c,cartList:s,changeCartInfo:n,changeItemCheck:o,changeCartClear:r,setCartItemChecked:i,showCart:_,handleClickCartShow:l}}};const dt=(0,q.Z)(lt,[["render",it],["__scopeId","data-v-7f52b260"]]);var pt=dt;const ut=()=>{const t=(0,d.yj)(),c=(0,l.qj)({item:{}}),a=async()=>{const a=await(0,u.U)(`/api/shop/${t.params.id}`);0===a?.errno&&a?.data&&(c.item=a.data)},{item:e}=(0,l.BK)(c);return{item:e,getItemData:a}},ht=()=>{const t=(0,d.tv)(),c=()=>{t.back()};return{handleBackClick:c}};var mt={name:"Shop",components:{ShopInfo:p.Z,Content:Y,Cart:pt},setup(){const{item:t,getItemData:c}=ut(),{handleBackClick:a}=ht();return c(),{item:t,handleBackClick:a}}};const Ct=(0,q.Z)(mt,[["render",_],["__scopeId","data-v-1c798403"]]);var kt=Ct}}]);
//# sourceMappingURL=shop.4cbab5eb.js.map